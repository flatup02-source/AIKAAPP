# AIKA18 LINEボット - 無料プランでの動作確認

## 概要

AIKA18のLINEボットシステムで使用している各サービスの無料プランと制限について説明します。

## 各サービスの無料プラン状況

### ✅ 完全無料で利用可能

#### 1. LINE Messaging API
- **無料プラン**: あり
- **制限**: 
  - メッセージ送信: 月間500通まで無料
  - Webhook: 無制限
  - リッチメニュー: 無料
- **注意**: 500通を超えると有料（1通あたり約0.1円）
- **結論**: 小規模運用なら無料で可能

#### 2. n8n
- **無料プラン**: セルフホスティング版は完全無料
- **制限**: 
  - クラウド版: 月間2,000実行まで無料
  - セルフホスティング: 無制限（自前サーバーが必要）
- **推奨**: Docker Composeでセルフホスティング（完全無料）
- **結論**: セルフホスティングなら完全無料

#### 3. Firebase
- **無料プラン**: Sparkプラン（無料）
- **制限**:
  - Authentication: 月間50,000認証まで無料
  - Firestore: 1GBストレージ、50,000読み取り/日まで無料
  - Storage: 5GBストレージ、1GB転送/日まで無料
- **結論**: 小規模運用なら無料で可能

### ⚠️ 無料プランあり（制限あり）

#### 4. Dify
- **無料プラン**: あり（Community版）
- **制限**:
  - API呼び出し: 月間200回まで無料
  - セルフホスティング: 可能（完全無料、自前サーバー必要）
- **注意**: 
  - クラウド版は200回/月で制限
  - セルフホスティングなら無制限
- **推奨**: セルフホスティングまたはAPI呼び出し回数を節約
- **結論**: セルフホスティングなら完全無料、クラウド版は制限あり

#### 5. Google Cloud Platform
- **無料プラン**: あり（Always Free）
- **制限**:
  - Video Intelligence API: 月間1,000分まで無料
  - Cloud Storage: 5GBストレージ、1GB転送/月まで無料
  - Cloud Run: 月間200万リクエスト、360,000GB秒まで無料
- **注意**: 
  - 動画解析は1,000分/月まで無料
  - 超過すると有料（$0.10/分）
- **結論**: 小規模運用なら無料で可能

### ❌ 無料プランなし（または制限が厳しい）

#### 6. Make.com
- **無料プラン**: あり（制限が厳しい）
- **制限**:
  - 月間1,000操作まで無料
  - データ転送: 10MBまで無料
- **注意**: 
  - 動画処理はデータ転送が大きいため、すぐに制限に達する可能性
  - n8nの方が無料で使いやすい
- **結論**: 小規模なら可能だが、n8n推奨

## 完全無料で動かす方法

### 推奨構成（完全無料）

```
LINE Messaging API (無料プラン)
    ↓
n8n (セルフホスティング - 完全無料)
    ↓
Dify (セルフホスティング - 完全無料)
    ↓
Google Cloud Platform (Always Free)
    ↓
Firebase (Sparkプラン - 無料)
```

### 必要なもの

1. **サーバー（VPS）**: 
   - n8nとDifyをセルフホスティングするため
   - 無料オプション:
     - Oracle Cloud Free Tier (2コア、24GB RAM)
     - Google Cloud Platform Always Free (f1-micro)
     - AWS Free Tier (t2.micro)

2. **ドメイン（オプション）**:
   - LINE WebhookにはHTTPSが必要
   - 無料オプション:
     - Cloudflare Tunnel（無料）
     - ngrok（無料版あり、制限あり）

## コスト試算（完全無料構成）

### 月間コスト: **0円**

#### 前提条件
- LINEメッセージ: 500通/月以内
- Dify API呼び出し: セルフホスティング（無制限）
- 動画解析: 1,000分/月以内
- サーバー: Oracle Cloud Free Tier使用

#### 各サービスの使用量目安
- LINE: 500通/月（無料枠内）
- n8n: セルフホスティング（無料）
- Dify: セルフホスティング（無料）
- GCP: Always Free枠内
- Firebase: Sparkプラン（無料枠内）

## 制限を超える場合のコスト

### 月間1,000通のLINEメッセージの場合
- LINE: 500通無料 + 500通有料 = **約50円/月**

### 月間5,000分の動画解析の場合
- GCP Video Intelligence: 1,000分無料 + 4,000分有料 = **約$400/月（約60,000円）**

### Difyクラウド版を使用する場合
- 200回/月無料 + 超過分 = **約$10/月（約1,500円）**

## 完全無料で動かすための推奨設定

### 1. n8nのセルフホスティング

```bash
# docker-compose.n8n.ymlを使用
docker-compose -f docker-compose.n8n.yml up -d
```

### 2. Difyのセルフホスティング

```bash
# Docker ComposeでDifyを起動
git clone https://github.com/langgenius/dify.git
cd dify/docker
docker-compose up -d
```

### 3. サーバーの無料オプション

#### Oracle Cloud Free Tier（推奨）
- 2コア、24GB RAM
- 無期限無料
- n8nとDifyの両方を動かせる

#### Google Cloud Platform Always Free
- f1-microインスタンス
- 月間750時間まで無料
- 1コア、0.6GB RAM（制限あり）

### 4. HTTPSの無料設定

#### Cloudflare Tunnel（推奨）
- 完全無料
- ドメイン不要
- 簡単にHTTPS化

#### ngrok（開発用）
- 無料版あり
- セッション時間制限あり
- 本番環境には不向き

## 無料プランでの制限と対策

### 制限1: LINEメッセージ500通/月
**対策**: 
- メッセージ送信を最適化
- 必要時のみ返信
- バッチ処理でまとめて送信

### 制限2: Dify API 200回/月（クラウド版）
**対策**: 
- セルフホスティングに切り替え（完全無料）
- または、キャッシュを活用してAPI呼び出しを削減

### 制限3: GCP動画解析1,000分/月
**対策**: 
- 動画の長さを制限（例: 30秒まで）
- 解析頻度を制限
- または、簡易的な解析に変更

### 制限4: Make.com 1,000操作/月
**対策**: 
- n8nに切り替え（セルフホスティングなら無制限）
- または、操作を最適化

## まとめ

### ✅ 完全無料で動かすには

1. **n8n**: セルフホスティング（完全無料）
2. **Dify**: セルフホスティング（完全無料）
3. **LINE**: 無料プラン（500通/月まで）
4. **GCP**: Always Free枠内で使用
5. **Firebase**: Sparkプラン（無料）

### ⚠️ 注意点

- サーバーが必要（Oracle Cloud Free Tier推奨）
- セルフホスティングの設定が必要
- 制限内での運用が必要

### 💡 推奨構成

**完全無料構成**:
- Oracle Cloud Free Tier（サーバー）
- n8n（セルフホスティング）
- Dify（セルフホスティング）
- LINE Messaging API（無料プラン）
- GCP Always Free
- Firebase Sparkプラン

**月間コスト: 0円**（制限内で使用する場合）

## 次のステップ

1. Oracle Cloud Free Tierでアカウント作成
2. n8nとDifyをセルフホスティング
3. Cloudflare TunnelでHTTPS化
4. LINE Webhookを設定
5. テスト実行

詳細なセットアップ手順は、各サービスの公式ドキュメントを参照してください。
